!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Kluginn=e():t.Kluginn=e()}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t,e={}){this.core=t,this.$k=t.$k,this.$=t.$,this.config={},this.option=e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2),o=n(3),i=n(4),s=n(5),u=n(6);e.default=class{constructor(t){if(!kintone)throw new Error("Kluginn only works with kintone !!");this.$=jQuery,this.$k=kintone,this.plugin_id=this.$k.$PLUGIN_ID,this.option=t,this.config=new r.default(this),this.api=new o.default(this),this.ui=new i.default(this),this.debug=new s.default(this),this.vendor={},this.vendor.jquery=jQuery,this.vendor.underscore=_,this.vendor.FM=FM,this.vendor.Swal=Swal,this.vendor.papaparse=Papa,this.service={},this.service.google=new u.default,this.external={gapi:"https://apis.google.com/js/api.js"}}init(t={}){var e=this;return new Promise((function(t,n){var r=[];for(var o in e.external)r.push(e.load(e.external[o]));Promise.race(r).then(t).catch(n)}))}load(t){return new Promise((function(e,n){var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=e,r.onerror=n,document.head.appendChild(r)}))}dialog(t){var e;return e=(e=t instanceof Array?t:[t]).map((function(t){return t.customContainerClass=t.customContainerClass||"BSTRP",t})),Swal.queue(e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0);e.default=class extends r.default{constructor(t,e={}){super(t,e),this.selector={form_input_class:"plugin-data"}}init(){this.$form=this.$(".js-submit-settings"),this.update_form()}save(t){var e=this;return new e.$k.Promise((function(n,r){try{t.json=JSON.stringify(t.json||{}),e.$k.plugin.app.setConfig(t,(function(){e.update_form(),n(e.config)}))}catch(t){r(t)}}))}fetch(){return this.config=this.core.$k.plugin.app.getConfig(this.core.plugin_id),this.config.json=this.config.json?JSON.parse(this.config.json):{},this.config}update_form(){console.log("Updating form"),this.fetch(),this.update_input(this.config)}update_input(t){for(var e in t)this.core.$('[name="'+e+'"]').val(t[e])}retrieve_form_data(){var t=this,e={};return t.core.$("."+t.selector.form_input_class).each((function(n,r){var o=t.core.$(r),i=o.attr("name");e[i]=o.val()})),e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0);e.default=class extends r.default{constructor(t,e={}){super(t,e)}request(t,e,n){console.log("API Request["+t+"]",e);return this.$k.api(this.$k.api.url(e,!0),t.toUpperCase(),n?this.$.extend({app:this.$k.app.getId()},n||{}):null)}error_handler(t){return new Promise((function(e,n){return console.log("PLUGIN API ERROR",t),t.code,n(t)}))}fetch(t,e={}){return this.request("get","/k/v1/"+t,e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0);e.default=class extends r.default{constructor(t,e={}){super(t,e)}bind_action(t){var e=this,n="data-action";for(var r in console.log("applying",t),t){console.log("attaching event",r);var o=t[r];e.core.$(document).on(r,"[data-action]",e.core.$.proxy((function(t){console.log("called",t);var r=e.core.$(t.target),i=r.attr(n);i in o&&o[i].apply(r,[t])}),e.core))}}render(t,e){var n=document.getElementById("template:"+t);if(n){var r=_.template(this.$(n).html());return e?r(e):r}return"TEMPLATE ERROR"}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0);e.default=class extends r.default{constructor(t,e={}){super(t,e)}init(){}log(t){console.log("["+(this.core.option.namespace||"kluginn")+"]",t)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t={}){this.config=t}init(){this.ins=gapi;var t=FM.promise(),e=this;return e.oauth((function(){e.ins.client.init(e.config),t.resolve()}),(function(){t.reject()})),t}oauth(t,e){return this.ins.load("client:auth2",{callback:t,onerror:e})}signin(){return!!this.is_signedin()||this.ins.auth2.getAuthInstance().signIn()}is_signedin(){return!(!this.ins.auth2||!this.ins.auth2.getAuthInstance().isSignedIn.get())}}}])}));